name: 'Run BiocCheck'
inputs:
  working-directory:
    description: 'Specify the location of the package to check if it is not in the working directory.'
    required: false
    default: '.'
  arguments:
    description: 'Arguments provided to BiocCheck() to disable specific tests.'
    required: false
    default: ''
runs:
  using: "composite"
  steps:
    - name: Install system dependencies
      if: runner.os == 'Linux'
      run: sudo apt-get -y --quiet install libcurl4-openssl-dev
      shell: bash
    - run: |
        BiocManager::install('BiocCheck', quiet = TRUE, upgrade = FALSE, ask = FALSE)
      shell: Rscript {0}
    - run: |
        Rscript --vanilla ${{ github.action_path }}/run-bioc-check.R "${{ inputs.working-directory }}" "${{ inputs.arguments }}"
      shell: bash
